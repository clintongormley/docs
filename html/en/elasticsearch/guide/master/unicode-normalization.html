
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Living in a Unicode World</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide" /><link rel="up" href="token-normalization.html" title="Normalizing Tokens" /><link rel="prev" href="asciifolding-token-filter.html" title="You Have an Accent" /><link rel="next" href="case-folding.html" title="Unicode Case Folding" />
  
 
 	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
 	
	<meta name="description" content="" />
	<meta name="keywords" content="" />



	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
	<!-- For third-generation iPad with high-resolution Retina display: -->
	<link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">

	<!-- For iPhone with high-resolution Retina display: -->

	<link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">

	<!-- For first- and second-generation iPad: -->

	<link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">

	<link type="text/css" rel="stylesheet" href="/static/css/skel.css" />	
	<link type="text/css" rel="stylesheet" href="/static/css/style.css" />	
	<script src="/static/js/skel.min.js"></script>
	<script type="text/javascript">form_name = "common_layout"</script>
	<script src="/static/js/init.js"></script>
	<script src="/static/js/classie.js"></script>
	

	
	<link type="text/css" rel="stylesheet" href="/static/css/prettify.css" />	
	<script type="text/javascript" src="/static/js/prettify.js"></script>



<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript">
  jQuery(function() {
    jQuery('#guide a[id]').each(function() { this.href='#'+this.id });
    jQuery('pre.prettyprint').each(function() {
      var pre = jQuery(this);
      pre.css('position','absolute');
      pre.css('width','auto');
      var height = pre.innerHeight();
      pre.wrap('<div class="pre_wrapper" style="height:' + height + 'px"></div>');
    })
  });
</script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

</head>
<body >
	
	<div class="header-cont">
		<div id="header-wrapper">
			

<div class="container">
	<div class="row">
		<div class="12u">
			<section>
				<div class="row">
					<div class="8u 6u(small) 5u(xsmall)">
						<div id="elastic">
							<h1><a href="/"></a></h1>
						</div>
						<!-- Searchbar Input box -->
						<form method="get" action="/search" name="searchForm" class="header-search-form">
						   <input type="text" id="search-header" name="q" class="form-control global-input" placeholder="elastic{search}">
						</form>
					</div>
					<div class="4u 6u(small) 7u(xsmall)">
						<!-- Mobile Menu -->
						<div class="mobile-menu-wrapper">
							<ul class="m-shortcuts">
								<li><a id="header-search" class="m-search" href="#"></a></li>
								<li><a class="m-guide" href="/guide"></a></li>
							</ul>											
							<nav class="nav-menu">
								<div class="menu-button">
									<span></span>
								</div>
								<div class="nav-menu-list-wrap">
									<div class="nav-menu-list">
										<h3><a href="/products">Products</a></h3>
										<ul>
											<li><a href="/products/elasticsearch">Elasticsearch</a></li>
											<li><a href="/products/logstash">Logstash</a></li>
											<li><a href="/products/kibana">Kibana</a></li>
											<li><a href="/products/shield">Shield</a></li>
											<li><a href="/products/marvel">Marvel</a></li>
											<li><a href="/products/hadoop">Hadoop</a></li>
											<li><a href="/subscriptions">Support</a></li>
											<li><a href="/downloads">Downloads</a></li>
										</ul>
										<h3><a href="/subscriptions">Subscriptions</a></h3>
										<h3><a href="/learn">Learn</a></h3>
										<ul>
											<li><a href="/guide">Docs</a></li>
											<li><a href="/videos">Videos</a></li>
											<li><a href="http://purchases.elasticsearch.com" target="_blank">Training</a></li>
											<li><a href="/blog">Blog</a></li>
										</ul>
										<h3><a href="/community">Community</a></h3>
										<ul>
											<li><a href="/community/meetups">Meetups</a></li>
										</ul>
										<h3><a href="/use-cases">Use Cases</a></h3>
										<h3><a href="/about">About</a></h3>
										<ul>
											<li><a href="/about/leadership">Leadership</a></li>
											<li><a href="/about/board">Board of Directors</a></li>
											<li><a href="/about/careers">Careers</a></li>
											<li><a href="/about/partners">Partners</a></li>
											<li><a href="/about/press">Press</a></li>
										</ul>
									</div>
								</div>
							</nav>
						</div>
						<!-- Shortcuts -->
						<nav id="shortcuts">
							<ul class="links">
								
									<li class="sc-downloads grayscale"><a href="/downloads" id="header_downloads">downloads</a></li>
								
									<li class="sc-docs grayscale"><a href="/guide" id="header_guide">docs</a></li>
								
									<li class="sc-support grayscale"><a href="/subscriptions" id="header_subscriptions">support</a></li>
								
									<li class="sc-contact grayscale"><a href="/contact" id="header_contact">contact</a></li>
								
							</ul>
						</nav>
					</div>
				</div>
			</section>
			

<section class="desktop-main-nav">
	<div class="row">
		<div class="9u">
			<!-- Nav -->
			<nav id="nav">
				<ul>
					
					<li>
						<a href="/products" id="nav_products" >PRODUCTS</a>
						
						<ul class="dropdown">
							
								<li><a href="/products/elasticsearch" id="nav_elasticsearch" >elasticsearch</a></li>								
							
								<li><a href="/products/logstash" id="nav_logstash" >logstash</a></li>								
							
								<li><a href="/products/kibana" id="nav_kibana" >kibana</a></li>								
							
								<li><a href="/products/shield" id="nav_shield" >shield</a></li>								
							
								<li><a href="/products/marvel" id="nav_marvel" >marvel</a></li>								
							
								<li><a href="/products/hadoop" id="nav_hadoop" >hadoop</a></li>								
							
								<li><a href="/subscriptions" id="nav_support" >support</a></li>								
							
								<li><a href="/downloads" id="nav_downloads" >downloads</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/subscriptions" id="nav_subscriptions" >SUBSCRIPTIONS</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/learn" id="nav_learn" >LEARN</a>
						
						<ul class="dropdown">
							
								<li><a href="/guide" id="nav_guide" >docs</a></li>								
							
								<li><a href="/videos" id="nav_videos" >videos</a></li>								
							
								<li><a href="http://purchases.elastic.co" id="nav_training" >training</a></li>								
							
								<li><a href="/blog" id="nav_learn_blog" >blog</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/community" id="nav_community" >COMMUNITY</a>
						
						<ul class="dropdown">
							
								<li><a href="/community/meetups" id="nav_meetups" >meetups</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/use-cases" id="nav_usecases" >USE CASES</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/blog" id="nav_blog" >BLOG</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/about" id="nav_about" >ABOUT</a>
						
						<ul class="dropdown">
							
								<li><a href="/about/leadership" id="nav_leadership" >leadership</a></li>								
							
								<li><a href="/about/board" id="nav_board" >board of directors</a></li>								
							
								<li><a href="/about/careers" id="nav_careers" >careers</a></li>								
							
								<li><a href="/about/partners" id="nav_partners" >partners</a></li>								
							
								<li><a href="/about/press" id="nav_press" >press</a></li>								
								
						</ul>							
					</li>
					
				</ul>
			</nav>
		</div>
		<!-- Search -->
		<div class="3u">
			<div id="searchbar">
				<form method="get" action="/search" name="searchForm">
					<input type="text" value="" name="q" placeholder="elastic{search}">
					<button class="button icon" onclick="searchForm.submit()">GO</button>
				</form>
			</div>
		</div>
	</div>
</section>

		</div>
	</div>
</div>

<style>	
	
		.sc-downloads{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-docs{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-support{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-contact{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
		
</style>
		</div>
	</div>
  	<div id="content">
  		
  			
            <div id="pageheader">
    <div class="container">
        <header>
            <h1>Learn |</h1>
            <h2>Docs</h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide</a></span> » <span class="breadcrumb-link"><a href="languages.html">Dealing with Human Language </a></span> » <span class="breadcrumb-link"><a href="token-normalization.html">Normalizing Tokens</a></span> » <span class="breadcrumb-node">Living in a Unicode World</span></div><div class="navheader"><span class="prev"><a href="asciifolding-token-filter.html">
              « 
              You Have an Accent</a>
           
        </span><span class="next">
           
          <a href="case-folding.html">Unicode Case Folding
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="unicode-normalization"></a>Living in a Unicode World<a href="https://github.com/elasticsearch/elasticsearch-definitive-guide/edit/master/220_Token_normalization/30_Unicode_world.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="lowercase-token-filter.html">In That Case</a></span></dt><dt><span class="section"><a href="asciifolding-token-filter.html">You Have an Accent</a></span></dt><dt><span class="section"><a href="unicode-normalization.html">Living in a Unicode World</a></span></dt><dt><span class="section"><a href="case-folding.html">Unicode Case Folding</a></span></dt><dt><span class="section"><a href="character-folding.html">Unicode Character Folding</a></span></dt><dt><span class="section"><a href="sorting-collations.html">Sorting and Collations</a></span></dt></dl></div><p>When Elasticsearch compares one token with another, it does so at the byte
level. <a id="id-1.6.5.6.2.1" class="indexterm"></a>
<a id="id-1.6.5.6.2.2" class="indexterm"></a><a id="id-1.6.5.6.2.3" class="indexterm"></a>
<a id="id-1.6.5.6.2.4" class="indexterm"></a>
<a id="id-1.6.5.6.2.5" class="indexterm"></a>In other words, for two tokens to be considered the same, they need to
consist of exactly the same bytes.  Unicode, however, allows you to write the
same letter in different ways.</p><p>For instance, what’s the difference between <span class="emphasis"><em>é</em></span> and <span class="emphasis"><em>é</em></span>? It
depends on who you ask. According to Elasticsearch, the first one consists of
the two bytes <code class="literal">0xC3 0xA9</code>, and the second one consists of three bytes, <code class="literal">0x65
0xCC 0x81</code>.</p><p>According to Unicode, the differences in how they are represented as bytes is
irrelevant, and they are the same letter. The first one is the single letter
<code class="literal">é</code>, while the second is a plain <code class="literal">e</code> combined with an acute accent <code class="literal">´</code>.</p><p>If you get your data from more than one source, it may happen that you have
the same  letters encoded in different ways, which may result in one form of
<code class="literal">déjà</code> not matching another!</p><p>Fortunately, a solution is at hand.  There are four Unicode <span class="emphasis"><em>normalization
forms</em></span>, all of which convert Unicode characters into a standard format, making
all characters<a id="id-1.6.5.6.6.2" class="indexterm"></a>
<a id="id-1.6.5.6.6.3" class="indexterm"></a> comparable at a byte level: <code class="literal">nfc</code>, <code class="literal">nfd</code>, <code class="literal">nfkc</code>, <code class="literal">nfkd</code>.<a id="id-1.6.5.6.6.8" class="indexterm"></a><a id="id-1.6.5.6.6.9" class="indexterm"></a><a id="id-1.6.5.6.6.10" class="indexterm"></a><a id="id-1.6.5.6.6.11" class="indexterm"></a></p><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Unicode Normalization Forms</strong></p></div></div></div><p>The <span class="emphasis"><em>composed</em></span> forms—<code class="literal">nfc</code> and <code class="literal">nfkc</code>—represent characters in the fewest
bytes possible.<a id="id-1.6.5.6.7.2.4" class="indexterm"></a>  So <code class="literal">é</code> is represented as the single letter <code class="literal">é</code>.  The
<span class="emphasis"><em>decomposed</em></span> forms—<code class="literal">nfd</code> and <code class="literal">nfkd</code>—represent characters by their
constituent parts, that is <code class="literal">e</code> + <code class="literal">´</code>.<a id="id-1.6.5.6.7.2.12" class="indexterm"></a></p><p>The <span class="emphasis"><em>canonical</em></span> forms—<code class="literal">nfc</code> and <code class="literal">nfd</code>—represent ligatures like <code class="literal">ﬃ</code> or
<code class="literal">œ</code> as a single character,<a id="id-1.6.5.6.7.3.6" class="indexterm"></a> while the <span class="emphasis"><em>compatibility</em></span> forms—<code class="literal">nfkc</code> and
<code class="literal">nfkd</code>—break down these composed characters into a simpler multiletter
equivalent: <code class="literal">f</code> + <code class="literal">f</code> + <code class="literal">i</code> or <code class="literal">o</code> + <code class="literal">e</code>.</p></div><p>It doesn’t really matter which normalization form you choose, as long as all
your text is in the same form.  That way, the same tokens consist of the
same bytes.  That said, the <span class="emphasis"><em>compatibility</em></span> forms <a id="id-1.6.5.6.8.2" class="indexterm"></a>allow you to compare
ligatures like <code class="literal">ﬃ</code> with their simpler representation, <code class="literal">ffi</code>.</p><p>You can use the <code class="literal">icu_normalizer</code> token filter to <a id="id-1.6.5.6.9.2" class="indexterm"></a>ensure that all of your
tokens are in the same form:</p><pre class="programlisting prettyprint lang-js">PUT /my_index
{
  "settings": {
    "analysis": {
      "filter": {
        "nfkc_normalizer": { <a id="CO143-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
          "type": "icu_normalizer",
          "name": "nfkc"
        }
      },
      "analyzer": {
        "my_normalizer": {
          "tokenizer": "icu_tokenizer",
          "filter":  [ "nfkc_normalizer" ]
        }
      }
    }
  }
}</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO143-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Normalize all tokens into the <code class="literal">nfkc</code> normalization form.
</p></td></tr></table></div><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>Besides the <code class="literal">icu_normalizer</code> token filter mentioned previously, there is also an
<code class="literal">icu_normalizer</code> <span class="emphasis"><em>character</em></span> filter, which<a id="id-1.6.5.6.12.1.4" class="indexterm"></a> does the same job as the token
filter, but does so before the text reaches the tokenizer.  When using the
<code class="literal">standard</code> tokenizer or <code class="literal">icu_tokenizer</code>, this doesn’t really matter.  These
tokenizers know how to deal with all forms of Unicode correctly.</p><p>However, if you plan on using a different tokenizer, such as the <code class="literal">ngram</code>,
<code class="literal">edge_ngram</code>, or <code class="literal">pattern</code> tokenizers, it would make sense to use the
<code class="literal">icu_normalizer</code> character filter in preference to the token filter.</p></div></div><p>Usually, though, you will want to not only normalize the byte order of tokens,
but also lowercase them. This can be done with <code class="literal">icu_normalizer</code>, using
the custom normalization form <code class="literal">nfkc_cf</code>, which we discuss in the next section.</p></div><div class="navfooter"><span class="prev"><a href="asciifolding-token-filter.html">
              « 
              You Have an Accent</a>
           
        </span><span class="next">
           
          <a href="case-folding.html">Unicode Case Folding
               »
            </a></span></div>
<!-- end body -->

            </section>
<script type="text/javascript" >
  (function ($, $a, $title, $list) {
    $a = $('[id^="js-api-method-index"]');
    if (!$a.size()) return;
    $('#guide').addClass('js-client-docs');
    $list = $a.siblings('.itemizedlist').detach();
    $title = $(document.createElement('h2')).text('api methods')
    $a.parent().remove();
    $('.toc').first().append($(document.createElement('div')).addClass('js-api-method-index').append($title).append($list));
  }(jQuery));
</script>

            <!-- Footer -->
        
	<div id="footer-wrapper">
		<section id="footer" class="container">
			<div class="row">
				<div class="12u">
					<!-- Copyright -->
					<div id="copyright">
	<p>
		© 2015. All Rights Reserved - Elasticsearch
	</p>
	<ul class="links">
		<li>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</li>
		<li><a href="/legal/trademarks" id="footer_trademarks">Trademarks</a></li>
		<li><a href="/legal/terms-of-use" id="footer_terms">Terms</a></li>
		<li><a href="/legal/privacy-policy" id="footer_privacy">Privacy</a></li>
	</ul>
	<p>
		Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other&nbsp;countries.
	</p>
</div><!--<div class="row">
{replace4}
</div>-->
				</div>
			</div>					
		</section>
	</div>
			
	<!-- Social Media -->
	<div id="socialmedia-wrapper">
		<section id="socialmedia" class="container">
			<!-- social icons -->
			<div id="social">
				<ul class="links">
					
						<li class="facebook grayscale"><a href="http://www.facebook.com/elastic.co" target="_blank" id="footer_facebook"></a></li>
					
						<li class="twitter grayscale"><a href="https://www.twitter.com/elastic" target="_blank" id="footer_twitter"></a></li>
					
						<li class="linkedin grayscale"><a href="http://www.linkedin.com/company/elasticsearch" target="_blank" id="footer_linkedin"></a></li>
					
						<li class="xing grayscale"><a href="https://www.xing.com/companies/elasticsearch" target="_blank" id="footer_xing"></a></li>
					
				</ul>
			</div>
		</section>
	</div>


<style type="text/css">
	
		.facebook{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.twitter{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.linkedin{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.xing{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
</style>	

  	</div>
  	<!-- <div class="preloader">
    	<div class="status"></div>
	</div> -->
  	<style></style>
   	<script src="/static/js/jquery.min.js"></script>
<script src="/static/js/script.js"></script>
   	
   		<!-- Google Tag Manager -->
	<script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5"
													  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script>
	<!-- End Google Tag Manager -->
</body>