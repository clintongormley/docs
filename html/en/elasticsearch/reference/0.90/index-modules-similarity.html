
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Similarity module</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Reference [0.90]" /><link rel="up" href="index-modules.html" title="Index Modules" /><link rel="prev" href="index-modules-codec.html" title="Codec module" /><link rel="next" href="glossary.html" title="Glossary of terms" />
  
 
 	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
 	
	<meta name="description" content="" />
	<meta name="keywords" content="" />



	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
	<link type="text/css" rel="stylesheet" href="/static/css/skel.css" />		
	
	<script src="/static/js/jquery.min.js"></script>
	<script src="/static/js/loading.js"></script>
	<script src="/static/js/skel.min.js"></script>
	<script src="/static/js/skel-layers.min.js"></script>
	<script src="/static/js/classie.js"></script>	
	<script type="text/javascript">form_name = "common_layout"</script>
	<script src="/static/js/init.js"></script>
	
	<link type="text/css" rel="stylesheet" href="/static/css/prettify.css" />	
	<script type="text/javascript" src="/static/js/prettify.js"></script>



<link rel="stylesheet" type="text/css" href="/static/css/style.css" />
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript">
  jQuery(function() {
    jQuery('#guide a[id]').each(function() { this.href='#'+this.id });
    jQuery('pre.prettyprint').each(function() {
      var pre = jQuery(this);
      pre.css('position','absolute');
      pre.css('width','auto');
      var height = pre.innerHeight();
      pre.wrap('<div class="pre_wrapper" style="height:' + height + 'px"></div>');
    })
  });
</script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

</head>
<body >
	<!-- Google Tag Manager -->
	<script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5"
													  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script>
	<!-- End Google Tag Manager -->
	
	<div class="header-cont">
		<div id="header-wrapper">
			

<div class="container">
	<div class="row">
		<div class="12u">
			<section>
				<div class="row">
					<div class="8u 6u(small) 5u(xsmall)">
						<div id="elastic">
							<h1><a href="/"></a></h1>
						</div>
						<!-- Searchbar Input box -->
						<div class="header-search-form">
						   <input type="text" id="search-header" name="q" class="form-control global-input" placeholder="{elastic} search">
						</div>
					</div>
					<div class="4u 6u(small) 7u(xsmall)">
						<!-- Mobile Menu -->
						<div class="mobile-menu-wrapper">
							<ul class="m-shortcuts">
								<li><a id="header-search" class="m-search" href="#"></a></li>
								<li><a class="m-guide" href="#"></a></li>
							</ul>											
							<nav class="nav-menu">
								<div class="menu-button">
									<span></span>
								</div>
								<div class="nav-menu-list-wrap">
									<div class="nav-menu-list">
										<h3><a href="#">Products</a></h3>
										<ul>
											<li><a href="#">elasticsearch</a></li>
											<li><a href="#">logstash</a></li>
											<li><a href="#">kibana</a></li>
											<li><a href="#">shield</a></li>
											<li><a href="#">marvel</a></li>
											<li><a href="#">hadoop</a></li>
											<li><a href="#">support</a></li>
											<li><a href="#">downloads</a></li>
										</ul>
										<h3><a href="#">SUBSCRIPTIONS</a></h3>
										<h3><a href="#">LEARN</a></h3>
										<ul>
											<li><a href="#">guide</a></li>
											<li><a href="#">videos</a></li>
											<li><a href="#">training</a></li>
											<li><a href="#">blog</a></li>
										</ul>
									</div>
								</div>
							</nav>
						</div>
						<!-- Shortcuts -->
						<nav id="shortcuts">
							<ul class="links">
								
									<li class="sc-downloads grayscale"><a href="/downloads" id="header_downloads">downloads</a></li>
								
									<li class="sc-guide grayscale"><a href="/guide" id="header_guide">guide</a></li>
								
									<li class="sc-support grayscale"><a href="/subscriptions" id="header_subscriptions">support</a></li>
								
									<li class="sc-contact grayscale"><a href="/contact" id="header_contact">contact</a></li>
								
							</ul>
						</nav>
					</div>
				</div>
			</section>
			

<section class="desktop-main-nav">
	<div class="row">
		<div class="9u">
			<!-- Nav -->
			<nav id="nav">
				<ul>
					
					<li>
						<a href="/products" id="nav_products" >PRODUCTS</a>
						
						<ul class="dropdown">
							
								<li><a href="/products/elasticsearch" id="nav_elasticsearch" >elasticsearch</a></li>								
							
								<li><a href="/products/logstash" id="nav_logstash" >logstash</a></li>								
							
								<li><a href="/products/kibana" id="nav_kibana" >kibana</a></li>								
							
								<li><a href="/products/shield" id="nav_shield" >shield</a></li>								
							
								<li><a href="/products/marvel" id="nav_marvel" >marvel</a></li>								
							
								<li><a href="/products/hadoop" id="nav_hadoop" >hadoop</a></li>								
							
								<li><a href="/subscriptions" id="nav_support" >support</a></li>								
							
								<li><a href="/downloads" id="nav_downloads" >downloads</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/subscriptions" id="nav_subscriptions" >SUBSCRIPTIONS</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/learn" id="nav_learn" >LEARN</a>
						
						<ul class="dropdown">
							
								<li><a href="/guide" id="nav_guide" >guide</a></li>								
							
								<li><a href="/videos" id="nav_videos" >videos</a></li>								
							
								<li><a href="http://purchases.elasticsearch.com" id="nav_training" >training</a></li>								
							
								<li><a href="/blog" id="nav_learn_blog" >blog</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/community" id="nav_community" >COMMUNITY</a>
						
						<ul class="dropdown">
							
								<li><a href="/community/meetups" id="nav_meetups" >meetups</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/use-cases" id="nav_usecases" >USE CASES</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/blog" id="nav_blog" >BLOG</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/about" id="nav_about" >ABOUT</a>
						
						<ul class="dropdown">
							
								<li><a href="/about/leadership" id="nav_leadership" >leadership</a></li>								
							
								<li><a href="/about/board" id="nav_board" >board of directors</a></li>								
							
								<li><a href="/about/careers" id="nav_careers" >careers</a></li>								
							
								<li><a href="/about/partners" id="nav_partners" >partners</a></li>								
							
								<li><a href="/about/press" id="nav_press" >press</a></li>								
								
						</ul>							
					</li>
					
				</ul>
			</nav>
		</div>
		<!-- Search -->
		<div class="3u">
			<div id="searchbar">
				<form method="get" action="/search" name="searchForm">
					<input type="text" value="" name="q" placeholder="{elastic} search">
					<a class="button icon" onclick="searchForm.submit()">GO</a>
				</form>
			</div>
		</div>
	</div>
</section>

		</div>
	</div>
</div>

<style>	
	
		.sc-downloads{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-guide{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-support{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-contact{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
		
</style>
		</div>
	</div>
  	<div id="content">
  		
            <div id="pageheader">
    <div class="container">
        <header>
            <h1>Learn |</h1>
            <h2>Docs</h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Reference
      [0.90]
    </a></span> » <span class="breadcrumb-link"><a href="index-modules.html">Index Modules </a></span> » <span class="breadcrumb-node">Similarity module</span></div><div class="navheader"><span class="prev"><a href="index-modules-codec.html">
              « 
              Codec module</a>
           
        </span><span class="next">
           
          <a href="glossary.html">Glossary of terms
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="index-modules-similarity"></a>Similarity module<a href="https://github.com/elasticsearch/elasticsearch/edit/0.90/docs/reference/index-modules/similarity.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><div class="toc"><dl><dt><span class="chapter"><a href="index-modules-analysis.html">Analysis</a></span></dt><dt><span class="chapter"><a href="index-modules-allocation.html">Index Shard Allocation</a></span></dt><dt><span class="chapter"><a href="index-modules-slowlog.html">Index Slow Log</a></span></dt><dt><span class="chapter"><a href="index-modules-merge.html">Merge</a></span></dt><dt><span class="chapter"><a href="index-modules-store.html">Store</a></span></dt><dt><span class="chapter"><a href="index-modules-mapper.html">Mapper</a></span></dt><dt><span class="chapter"><a href="index-modules-translog.html">Translog</a></span></dt><dt><span class="chapter"><a href="index-modules-cache.html">Cache</a></span></dt><dt><span class="chapter"><a href="index-modules-fielddata.html">Field data</a></span></dt><dt><span class="chapter"><a href="index-modules-codec.html">Codec module</a></span></dt><dt><span class="chapter"><a href="index-modules-similarity.html">Similarity module</a></span></dt></dl></div><p>A similarity (scoring / ranking model) defines how matching documents
are scored. Similarity is per field, meaning that via the mapping one
can define a different similarity per field.</p><p>Configuring a custom similarity is considered a expert feature and the
builtin similarities are most likely sufficient as is described in the
<a class="link" href="mapping-core-types.html" title="Core Types">mapping section</a></p><p>Configuring similarities is a <code class="literal">0.90.0.Beta1</code> feature.</p><h3><a id="configuration"></a>Configuring a similarity<a href="https://github.com/elasticsearch/elasticsearch/edit/0.90/docs/reference/index-modules/similarity.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Most existing or custom Similarities have configuration options which
can be configured via the index settings as shown below. The index
options can be provided when creating an index or updating index
settings.</p><pre class="programlisting prettyprint lang-js">"similarity" : {
  "my_similarity" : {
    "type" : "DFR",
    "basic_model" : "g",
    "after_effect" : "l",
    "normalization" : "h2",
    "normalization.h2.c" : "3.0"
  }
}</pre><p>Here we configure the DFRSimilarity so it can be referenced as
<code class="literal">my_similarity</code> in mappings as is illustrate in the below example:</p><pre class="programlisting prettyprint lang-js">{
  "book" : {
    "properties" : {
      "title" : { "type" : "string", "similarity" : "my_similarity" }
    }
}</pre><h3><a id="_available_similarities"></a>Available similarities<a href="https://github.com/elasticsearch/elasticsearch/edit/0.90/docs/reference/index-modules/similarity.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><h4><a id="default-similarity"></a>Default similarity<a href="https://github.com/elasticsearch/elasticsearch/edit/0.90/docs/reference/index-modules/similarity.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The default similarity that is based on the TF/IDF model. This
similarity has the following option:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">discount_overlaps</code>
</span></dt><dd>
    Determines whether overlap tokens (Tokens with
    0 position increment) are ignored when computing norm. By default this
    is true, meaning overlap tokens do not count when computing norms.
</dd></dl></div><p>Type name: <code class="literal">default</code></p><h4><a id="bm25"></a>BM25 similarity<a href="https://github.com/elasticsearch/elasticsearch/edit/0.90/docs/reference/index-modules/similarity.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Another TF/IDF based similarity that has built-in tf normalization and
is supposed to work better for short fields (like names). See
<a class="ulink" href="http://en.wikipedia.org/wiki/Okapi_BM25" target="_top">Okapi_BM25</a> for more details.
This similarity has the following options:</p><div class="horizontal"><table cellpadding="4px" border="0"><colgroup><col /><col /></colgroup><tbody valign="top"><tr><td valign="top">
<p>
<code class="literal">k1</code>
</p>
</td><td valign="top">
<p>
    Controls non-linear term frequency normalization
    (saturation).
</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">b</code>
</p>
</td><td valign="top">
<p>
    Controls to what degree document length normalizes tf values.
</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">discount_overlaps</code>
</p>
</td><td valign="top">
<p>
    Determines whether overlap tokens (Tokens with
    0 position increment) are ignored when computing norm. By default this
    is true, meaning overlap tokens do not count when computing norms.
</p>
</td></tr></tbody></table></div><p>Type name: <code class="literal">BM25</code></p><h4><a id="drf"></a>DFR similarity<a href="https://github.com/elasticsearch/elasticsearch/edit/0.90/docs/reference/index-modules/similarity.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Similarity that implements the
<a class="ulink" href="http://lucene.apache.org/core/4_1_0/core/org/apache/lucene/search/similarities/DFRSimilarity.html" target="_top">divergence
from randomness</a> framework. This similarity has the following options:</p><div class="horizontal"><table cellpadding="4px" border="0"><colgroup><col /><col /></colgroup><tbody valign="top"><tr><td valign="top">
<p>
<code class="literal">basic_model</code>
</p>
</td><td valign="top">
<p>
    Possible values: <code class="literal">be</code>, <code class="literal">d</code>, <code class="literal">g</code>, <code class="literal">if</code>, <code class="literal">in</code>, <code class="literal">ine</code> and <code class="literal">p</code>.
</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">after_effect</code>
</p>
</td><td valign="top">
<p>
    Possible values: <code class="literal">no</code>, <code class="literal">b</code> and <code class="literal">l</code>.
</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">normalization</code>
</p>
</td><td valign="top">
<p>
    Possible values: <code class="literal">no</code>, <code class="literal">h1</code>, <code class="literal">h2</code>, <code class="literal">h3</code> and <code class="literal">z</code>.
</p>
</td></tr></tbody></table></div><p>All options but the first option need a normalization value.</p><p>Type name: <code class="literal">DFR</code></p><h4><a id="ib"></a>IB similarity.<a href="https://github.com/elasticsearch/elasticsearch/edit/0.90/docs/reference/index-modules/similarity.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p><a class="ulink" href="http://lucene.apache.org/core/4_1_0/core/org/apache/lucene/search/similarities/IBSimilarity.html" target="_top">Information
based model</a> . This similarity has the following options:</p><div class="horizontal"><table cellpadding="4px" border="0"><colgroup><col /><col /></colgroup><tbody valign="top"><tr><td valign="top">
<p>
<code class="literal">distribution</code>
</p>
</td><td valign="top">
<p>
Possible values: <code class="literal">ll</code> and <code class="literal">spl</code>.
</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">lambda</code>
</p>
</td><td valign="top">
<p>
Possible values: <code class="literal">df</code> and <code class="literal">ttf</code>.
</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">normalization</code>
</p>
</td><td valign="top">
<p>
Same as in <code class="literal">DFR</code> similarity.
</p>
</td></tr></tbody></table></div><p>Type name: <code class="literal">IB</code></p><h4><a id="default-base"></a>Default and Base Similarities<a href="https://github.com/elasticsearch/elasticsearch/edit/0.90/docs/reference/index-modules/similarity.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>By default, Elasticsearch will use whatever similarity is configured as
<code class="literal">default</code>. However, the similarity functions <code class="literal">queryNorm()</code> and <code class="literal">coord()</code>
are not per-field. Consequently, for expert users wanting to change the
implementation used for these two methods, while not changing the
<code class="literal">default</code>, it is possible to configure a similarity with the name
<code class="literal">base</code>. This similarity will then be used for the two methods.</p><p>You can change the default similarity for all fields like this:</p><pre class="programlisting prettyprint lang-js">index.similarity.default.type: BM25</pre></div><div class="navfooter"><span class="prev"><a href="index-modules-codec.html">
              « 
              Codec module</a>
           
        </span><span class="next">
           
          <a href="glossary.html">Glossary of terms
               »
            </a></span></div>
<!-- end body -->

            </section>
<script type="text/javascript" >
  (function ($, $a, $title, $list) {
    $a = $('[id^="js-api-method-index"]');
    if (!$a.size()) return;
    $('#guide').addClass('js-client-docs');
    $list = $a.siblings('.itemizedlist').detach();
    $title = $(document.createElement('h2')).text('api methods')
    $a.parent().remove();
    $('.toc').first().append($(document.createElement('div')).addClass('js-api-method-index').append($title).append($list));
  }(jQuery));
</script>

            <!-- Footer -->
        
	<div id="footer-wrapper">
		<section id="footer" class="container">
			<div class="row">
				<div class="12u">
					<!-- Copyright -->
					<div id="copyright">
						<p>&copy; 2015. All Rights Reserved - Elasticsearch</p>
						<ul class="links">
							<li>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</li>
							
							<li><a href="/legal/trademarks" id="footer_trademarks">Trademarks</a></li>
							
							<li><a href="/legal/terms-of-use" id="footer_terms">Terms</a></li>
							
							<li><a href="/legal/privacy-policy" id="footer_privacy">Privacy</a></li>
							
						</ul>
					</div>
				</div>
			</div>					
		</section>
	</div>
			
	<!-- Social Media -->
	<div id="socialmedia-wrapper">
		<section id="socialmedia" class="container">
			<!-- social icons -->
			<div id="social">
				<ul class="links">
					
						<li class="facebook grayscale"><a href="http://www.facebook.com/elastic.co" target="_blank" id="footer_facebook"></a></li>
					
						<li class="twitter grayscale"><a href="https://www.twitter.com/elastic" target="_blank" id="footer_twitter"></a></li>
					
						<li class="linkedin grayscale"><a href="http://www.linkedin.com/company/elastic.co" target="_blank" id="footer_linkedin"></a></li>
					
						<li class="xing grayscale"><a href="https://www.xing.com/companies/elasticsearch" target="_blank" id="footer_xing"></a></li>
					
				</ul>
			</div>
		</section>
	</div>


<style type="text/css">
	
		.facebook{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.twitter{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.linkedin{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.xing{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
</style>	

  	</div>
  	<div class="preloader">
    	<div class="status"></div>
	</div>
  	<style></style>
   	<link type="text/css" rel="stylesheet" href="/static/css/flexslider.css" >

<script src="/static/js/jquery.flexslider.min.js"></script>
<script src="/static/js/jquery.dropdown.min.js"></script>
<script src="/static/js/script.js"></script>
   	
</body>