
<!DOCTYPE HTML>
<html lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Getting Started (Long Version)</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Shield - Elasticsearch Security Plugin [1.2]" /><link rel="up" href="index.html" title="Shield - Elasticsearch Security Plugin [1.2]" /><link rel="prev" href="quick-getting-started.html" title="Getting Started (Short Version)" /><link rel="next" href="authorization.html" title="Authorization" />
  
 
 	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<link type="text/css" rel="stylesheet" href="/static/css/en-us.css" />
 	
	<meta name="description" content="" />
	<meta name="keywords" content="" />



	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
	<!-- For third-generation iPad with high-resolution Retina display: -->
	<link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">

	<!-- For iPhone with high-resolution Retina display: -->

	<link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">

	<!-- For first- and second-generation iPad: -->

	<link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
	<!-- <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'> -->
	<link type="text/css" rel="stylesheet" href="/static/css/skel.css" />	
	<link type="text/css" rel="stylesheet" href="/static/css/style.css" />	
	<script src="/static/js/skel.min.js"></script>
	<script type="text/javascript">form_name = "guide_template"</script>
	<script src="/static/js/init.js"></script>
	<script src="/static/js/classie.js"></script>
	<!--<script type="text/javascript">
	    (function() {
	        var path = '//easy.myfonts.net/v2/js?sid=10336(font-family=Avenir+35+Light)&sid=10338(font-family=Avenir+55+Roman)&sid=10340(font-family=Avenir+85+Heavy)&sid=10344(font-family=Avenir+65+Medium)&key=nAD6PCOPrX',
	            protocol = ('https:' == document.location.protocol ? 'https:' : 'http:'),
	            trial = document.createElement('script');
	        trial.type = 'text/javascript';
	        trial.async = true;
	        trial.src = protocol + path;
	        var head = document.getElementsByTagName("head")[0];
	        head.appendChild(trial);
	    })();
	</script>-->

	
	<link type="text/css" rel="stylesheet" href="/static/css/prettify.css" />
	<link rel="stylesheet" type="text/css" href="/static/css/guide_template.css" />	
	<script type="text/javascript" src="/static/js/prettify.js"></script>

	

<link rel="stylesheet" type="text/css" href="styles.css" />

</head>
<body >
	<!-- Google Tag Manager -->
	<script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5"
													  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script>
	<!-- End Google Tag Manager -->
	
	<div class="header-cont">
		<div id="header-wrapper">
			


<div class="container w100">
	<div class="row">
		<div class="12u">
			

<section>
	<div class="row">
		<div class="8u 6u(small) 6u(xsmall)">
			<div id="elastic">
				<h1><a href="/"></a></h1>
			</div>
			<!-- Searchbar Input box -->
			<form method="get" action="/search" name="searchForm" class="header-search-form">
			   <input type="text" id="search-header-autocomplete" name="q" class="form-control global-input" placeholder="elastic{search}">
			</form>
			<div class="mobile-auto-complete"></div> 
		</div>
		<div class="4u 6u(small) 6u(xsmall)">
			<!-- Mobile Menu -->
			<div class="mobile-menu-wrapper">
				<ul class="m-shortcuts">
					
					<li><a href="#" class="m-search" id="header-search"></a></li>
					
					<li><a href="/guide" class="m-guide" id=""></a></li>
					
					<li><a href="/contact" class="m-contact" id=""></a></li>
					
				</ul>											
				<nav class="nav-menu">
					<div class="menu-button">
						<span></span>
					</div>
					<div class="nav-menu-list-wrap">
						<div class="nav-menu-list">
							
								<h3><a href="/products" id="nav_products" >PRODUCTS</a></h3>

								
								<ul>
									
									<li><a href="/products/elasticsearch" id="nav_elasticsearch" >elasticsearch</a></li>
									
									<li><a href="/products/logstash" id="nav_logstash" >logstash</a></li>
									
									<li><a href="/products/kibana" id="nav_kibana" >kibana</a></li>
									
									<li><a href="/products/shield" id="nav_shield" >shield</a></li>
									
									<li><a href="/products/marvel" id="nav_marvel" >marvel</a></li>
									
									<li><a href="/products/hadoop" id="nav_hadoop" >hadoop</a></li>
									
									<li><a href="/subscriptions" id="nav_support" >support</a></li>
									
									<li><a href="/downloads" id="nav_downloads" >downloads</a></li>
									
								</ul>
								
							
								<h3><a href="/subscriptions" id="nav_subscriptions" >SUBSCRIPTIONS</a></h3>

								
							
								<h3><a href="/learn" id="nav_learn" >LEARN</a></h3>

								
								<ul>
									
									<li><a href="/guide" id="nav_guide" >docs</a></li>
									
									<li><a href="/videos" id="nav_videos" >videos</a></li>
									
									<li><a href="http://purchases.elastic.co" id="nav_training" >training</a></li>
									
									<li><a href="/blog" id="nav_learn_blog" >blog</a></li>
									
									<li><a href="/elasticon" id="nav_learn_elasticon" >elastic{ON}</a></li>
									
								</ul>
								
							
								<h3><a href="/community" id="nav_community" >COMMUNITY</a></h3>

								
								<ul>
									
									<li><a href="/community/meetups" id="nav_meetups" >meetups</a></li>
									
								</ul>
								
							
								<h3><a href="/use-cases" id="nav_usecases" >USE CASES</a></h3>

								
							
								<h3><a href="/blog" id="nav_blog" >BLOG</a></h3>

								
							
								<h3><a href="/about" id="nav_about" >ABOUT</a></h3>

								
								<ul>
									
									<li><a href="/about/leadership" id="nav_leadership" >leadership</a></li>
									
									<li><a href="/about/board" id="nav_board" >board of directors</a></li>
									
									<li><a href="/about/careers" id="nav_careers" >careers</a></li>
									
									<li><a href="/about/partners" id="nav_partners" >partners</a></li>
									
									<li><a href="/about/press" id="nav_press" >press</a></li>
									
								</ul>
								
							
						</div>
					</div>
				</nav>
			</div>
			<!-- Shortcuts -->
			<nav id="shortcuts">
				<ul class="links">
					
						<li class="sc-downloads grayscale"><a href="/downloads" id="header_downloads">downloads</a></li>
					
						<li class="sc-docs grayscale"><a href="/guide" id="header_guide">docs</a></li>
					
						<li class="sc-support grayscale"><a href="/subscriptions" id="header_subscriptions">support</a></li>
					
						<li class="sc-contact grayscale"><a href="/contact" id="header_contact">contact</a></li>
					
				</ul>
			</nav>
		</div>
	</div>
</section>


<section class="desktop-main-nav">
	<div class="row">
		<div class="9u">
			<!-- Nav -->
			<nav id="nav">
				<ul>
					
					<li>
						<a href="/products" id="nav_products" >PRODUCTS</a>
						
						<ul class="dropdown">
							
								<li><a href="/products/elasticsearch" id="nav_elasticsearch" >elasticsearch</a></li>								
							
								<li><a href="/products/logstash" id="nav_logstash" >logstash</a></li>								
							
								<li><a href="/products/kibana" id="nav_kibana" >kibana</a></li>								
							
								<li><a href="/products/shield" id="nav_shield" >shield</a></li>								
							
								<li><a href="/products/marvel" id="nav_marvel" >marvel</a></li>								
							
								<li><a href="/products/hadoop" id="nav_hadoop" >hadoop</a></li>								
							
								<li><a href="/subscriptions" id="nav_support" >support</a></li>								
							
								<li><a href="/downloads" id="nav_downloads" >downloads</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/subscriptions" id="nav_subscriptions" >SUBSCRIPTIONS</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/learn" id="nav_learn" >LEARN</a>
						
						<ul class="dropdown">
							
								<li><a href="/guide" id="nav_guide" >docs</a></li>								
							
								<li><a href="/videos" id="nav_videos" >videos</a></li>								
							
								<li><a href="http://purchases.elastic.co" id="nav_training" >training</a></li>								
							
								<li><a href="/blog" id="nav_learn_blog" >blog</a></li>								
							
								<li><a href="/elasticon" id="nav_learn_elasticon" >elastic{ON}</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/community" id="nav_community" >COMMUNITY</a>
						
						<ul class="dropdown">
							
								<li><a href="/community/meetups" id="nav_meetups" >meetups</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/use-cases" id="nav_usecases" >USE CASES</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/blog" id="nav_blog" >BLOG</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/about" id="nav_about" >ABOUT</a>
						
						<ul class="dropdown">
							
								<li><a href="/about/leadership" id="nav_leadership" >leadership</a></li>								
							
								<li><a href="/about/board" id="nav_board" >board of directors</a></li>								
							
								<li><a href="/about/careers" id="nav_careers" >careers</a></li>								
							
								<li><a href="/about/partners" id="nav_partners" >partners</a></li>								
							
								<li><a href="/about/press" id="nav_press" >press</a></li>								
								
						</ul>							
					</li>
					
				</ul>
			</nav>
		</div>
		<!-- Search -->
		<div class="3u">
			<div id="searchbar">
				<form method="get" action="/search" name="searchForm">
					<input type="text" value="" name="q" placeholder="elastic{search}" id="autocomplete">
					<button class="button icon" onclick="searchForm.submit()">GO</button>
				</form>
			</div>
			<div class="nav-auto-complete"></div>
		</div>
	</div>
</section>

		</div>
	</div>
</div>

<style>	
	
		.sc-downloads{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-docs{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-support{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-contact{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	

	
		.m-shortcuts li a.m-search {
			background: url("/assets/blt174b13be89ff803c/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
			background-size: contain;}
	
		.m-shortcuts li a.m-guide {
			background: url("/assets/blt5ba03f594a7d610a/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
			background-size: contain;}
	
		.m-shortcuts li a.m-contact {
			background: url("/assets/blt38c3e853c4b1174d/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
			background-size: contain;}
		
</style>
		</div>
	</div>
  	<div id="content">
  		
  			
            <div id="pageheader">
    <div class="container">
        <header>
            <h1>Learn |</h1>
            <h2>Docs</h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Shield - Elasticsearch Security Plugin
      [1.2]
    </a></span> » <span class="breadcrumb-node">Getting Started (Long Version)</span></div><div class="navheader"><span class="prev"><a href="quick-getting-started.html">
              « 
              Getting Started (Short Version)</a>
           
        </span><span class="next">
           
          <a href="authorization.html">Authorization
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="getting-started"></a>Getting Started (Long Version)</h1></div></div></div><div class="toc"><dl><dt><span class="chapter"><a href="introduction.html">Introduction</a></span></dt><dt><span class="chapter"><a href="architecture.html">Architecture Overview</a></span></dt><dt><span class="chapter"><a href="quick-getting-started.html">Getting Started (Short Version)</a></span></dt><dt><span class="chapter"><a href="getting-started.html">Getting Started (Long Version)</a></span></dt><dt><span class="chapter"><a href="authorization.html">Authorization</a></span></dt><dt><span class="chapter"><a href="authentication.html">Authentication</a></span></dt><dt><span class="chapter"><a href="securing-nodes.html">Securing Nodes</a></span></dt><dt><span class="chapter"><a href="auditing.html">Auditing</a></span></dt><dt><span class="chapter"><a href="clients.html">Integrating Shield with clients</a></span></dt><dt><span class="chapter"><a href="certificate-authority.html">Appendix 1. Running a Certificate Authority</a></span></dt><dt><span class="chapter"><a href="license-management.html">Appendix 2. License Management</a></span></dt><dt><span class="chapter"><a href="limitations.html">Appendix 3. Limitations</a></span></dt><dt><span class="chapter"><a href="securing-aliases.html">Appendix 4. Securing Indices &amp; Aliases</a></span></dt><dt><span class="chapter"><a href="tribe-node.html">Appendix 5. Tribe Node</a></span></dt><dt><span class="chapter"><a href="example.html">Appendix 6. Full <code class="literal">esusers</code> Example</a></span></dt><dt><span class="chapter"><a href="trouble-shooting.html">Appendix 7. Trouble Shooting</a></span></dt><dt><span class="chapter"><a href="reference.html">Appendix 8. Reference</a></span></dt><dt><span class="chapter"><a href="release-notes.html">Appendix 9. Release Notes</a></span></dt></dl></div><p>Security is installed as an Elasticsearch plugin. The plugin must be installed on every node in the cluster, and every
node must be restarted after installation. Plan for a complete cluster restart before beginning the installation
process.</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>Shield 1.2.x is compatible with Elasticsearch 1.5.0 and above.</p></div></div><h3><a id="_configuring_your_environment"></a>Configuring your environment</h3><p>If you install Elasticsearch as a package or you specify a custom configuration directory, the command line
tools require you to specify the configuration directory. On Linux systems, add the following line to your
<code class="literal">.profile</code> file:</p><pre class="programlisting prettyprint lang-shell">export ES_JAVA_OPTS="-Des.path.conf=/etc/elasticsearch"</pre><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>When using <code class="literal">sudo</code> to run commands as a different user, the <code class="literal">ES_JAVA_OPTS</code> setting from your profile will not be
available in the other user’s environment. You can manually pass the environment variables to the command or you can
make the environment variable available by adding the following line to the <code class="literal">/etc/sudoers</code> file:</p></div></div><pre class="programlisting prettyprint lang-shell">Defaults    env_keep += "ES_JAVA_OPTS"</pre><p>On Windows systems, the <code class="literal">setx</code> command can be used to specify a custom configuration directory:</p><pre class="programlisting prettyprint lang-shell">setx ES_JAVA_OPTS "-Des.path.conf=C:\config"</pre><h3><a id="_shield_and_licensing"></a>Shield And Licensing</h3><p>Shield requires a license to operate and the licensing is managed by a separate plugin. For this reason,
the License plugin must be installed (without the license plugin Shield will prevent the node from starting up).</p><p>For instructions on how to install the License plugin, please refer to <a class="link" href="license-management.html" title="Appendix 2. License Management">License Management</a>.</p><p>Once you have the licensing plugin installed, you may begin working with Shield immediately. When elasticsearch starts for the
first time with Shield and the licensing plugin installed, a 30-day trial license for Shield will automatically be generated.
If you have a license for Shield that you would like to install, please refer to <a class="link" href="license-management.html#installing-license" title="Installing A License">installing a license</a>.</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>With a valid license, Shield will be fully operational. Upon license expiry, Shield will operate in a
            degraded mode, where cluster health, cluster stats, and index stats APIs will be blocked. All other operations will
            continue operating normally. Additional information can be found at the <a class="link" href="license-management.html#license-expiration" title="License Expiration">Shield license expiration</a>
            section.</p></div></div><h3><a id="_installing_the_shield_plugin"></a>Installing the Shield plugin</h3><p>Follow these steps on every node in the cluster:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
From the Elasticsearch home directory, run:
</p><pre class="programlisting prettyprint lang-sh">bin/plugin -i elasticsearch/shield/latest</pre></li><li class="listitem"><p class="simpara">
Restart your Elasticsearch node.
</p><p class="simpara">Before restarting your cluster, consider temporarily <a class="ulink" href="http://www.elastic.co/guide/en/elasticsearch/reference/current/modules-cluster.html" target="_top">disabling shard allocation</a>.</p></li></ol></div><p>If your server doesn’t have direct Internet access, see <a class="link" href="getting-started.html#manual_download" title="Manual Download">manual download</a> for an alternative way to
get the Security binaries.</p><h4><a id="manual_download"></a>Manual Download</h4><p>Elasticsearch’s <code class="literal">bin/plugin</code> script requires direct Internet access for downloading and installing the security plugin.
If your server doesn’t have Internet access, you can download the required binaries from the following link:</p><pre class="programlisting prettyprint lang-sh">https://download.elastic.co/elasticsearch/shield/shield-1.2.0.zip</pre><p>Transfer the compressed file to your server, then install the plugin with the <code class="literal">bin/plugin</code> script:</p><pre class="programlisting prettyprint lang-shell">bin/plugin -i shield -u file://PATH_TO_ZIP_FILE <a id="CO1-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO1-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Absolute path to Shield plugin zip distribution file (e.g. <code class="literal">file:///path/to/file/shield-1.2.0.zip</code>,
    note the three slashes at the beginning)
</p></td></tr></table></div><h3><a id="install-layout"></a>Shield Installation Layout</h3><p>Shield comes with its own set of configuration files and executable tools. These include:</p><div class="horizontal"><table cellpadding="4px" border="0"><colgroup><col /><col /></colgroup><tbody valign="top"><tr><td valign="top">
<p>
<a id="shield-bin"></a> <span class="strong"><strong>Executables</strong></span>
</p>
</td><td valign="top">
<p>
Shield’s bin directory is located at <code class="literal">$ES_HOME/bin/shield</code>. Consider adding this directory to
your <code class="literal">PATH</code> environment variable.
</p>
</td></tr><tr><td valign="top">
<p>
<a id="shield-config"></a> <span class="strong"><strong>Configuration</strong></span>
</p>
</td><td valign="top">
<p>
Shield’s config directory is located at <code class="literal">&lt;elasticsearch_config&gt;/shield</code> (where
<code class="literal">&lt;elasticsearch_config&gt;</code> refers to the standard config directory of
Elasticsearch - typically at <code class="literal">$ES_HOME/config</code>).
</p>
</td></tr></tbody></table></div><p>Unless otherwise stated, Shield’s settings are placed in the main
<code class="literal">elasticsearch.yml</code> configuration file.</p><h3><a id="message-authentication"></a>Message Authentication</h3><p>Message authentication verifies that a message has not been tampered with or corrupted in transit. To enable message
authentication, run the <code class="literal">syskeygen</code> tool without any options:</p><pre class="programlisting prettyprint lang-shell">bin/shield/syskeygen</pre><p>This creates the system key file in Shield’s <a class="link" href="getting-started.html#shield-config">config</a> directory, e.g. <code class="literal">config/shield/system_key</code>. You
can customize this file’s location by changing the value of the <code class="literal">shield.system_key.file</code> setting in the
<code class="literal">elasticsearch.yml</code> file.</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>Because the system key is a symmetric key, the same key must be on every node in the cluster. Copy the key to
           every node in the cluster after generating it.</p></div></div><h3><a id="_enabling_role_based_access_control"></a>Enabling Role-based Access Control</h3><p>Now that we have Shield installed, we’ll move to configuring the users (and their roles) with which we’ll be able to execute
various of APIs on Elasticsearch.</p><h4><a id="_defining_roles"></a>Defining Roles</h4><p>A <span class="emphasis"><em>role</em></span> encompasses a set of permissions over the cluster and/or the indices in it. Roles are defined in the
<code class="literal">$ES_HOME/config/shield/roles.yml</code> file.</p><p><strong>Example role definition. </strong>
</p><pre class="programlisting prettyprint lang-yaml"># All cluster rights
# All operations on all indices
admin: <a id="CO2-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
  cluster: all
  indices:
    '*': all

# monitoring cluster privileges
# All operations on all indices
power_user: <a id="CO2-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
  cluster: monitor
  indices:
    '*': all

# Read-only operations on indices
user: <a id="CO2-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
  indices:
    '*': read</pre><p>
</p><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO2-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The <code class="literal">admin</code> role enables full access to the cluster and all its indices.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO2-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The <code class="literal">power_user</code> role enables monitoring only access on the cluster and full access on all its indices.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO2-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The <code class="literal">user</code> role has no cluster wide permissions and only has data read access on all its indices.
</p></td></tr></table></div><p>For this quick getting started guide, we won’t need to change anything in the <code class="literal">roles.yml</code> file that comes out-of-the-box
with Shield, as it already defines the roles listed in the snippet above. To learn more on roles and how one can configure
them, please see <a class="link" href="authorization.html#roles" title="Roles, Permissions and Privileges">Roles</a>.</p><h4><a id="_defining_users"></a>Defining Users</h4><p>Shield supports different authentication realms that authenticate users from different sources. In this example, we’ll
use the internal <a class="link" href="esusers.html" title="esusers - Internal File Based Authentication"><code class="literal">esusers</code></a> realm that comes with Shield. The <code class="literal">esusers</code> realm supports user management using
the <code class="literal">esusers</code> command line tool from Shield’s <code class="literal">bin</code> directory.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The <code class="literal">esusers</code> realm is enabled by default when no realms are explicitly configured in <code class="literal">elasticsearch.yml</code>. For more
      information on realms configuration please see <a class="link" href="authentication.html#realms" title="Realms">Realms</a>.</p></div></div><pre class="programlisting prettyprint lang-shell">bin/shield/esusers useradd rdeniro -p taxidriver -r admin</pre><pre class="programlisting prettyprint lang-shell">bin/shield/esusers useradd alpacino -p godfather -r user</pre><p>The example above adds two users:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
The <code class="literal">rdeniro</code> user with password <code class="literal">taxidriver</code>, with the <code class="literal">admin</code> role in the cluster
</li><li class="listitem">
The <code class="literal">alpacino</code> user with password <code class="literal">godfather</code>, with the <code class="literal">user</code> role in the cluster
</li></ul></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>To ensure that Elasticsearch can read the user and role information at startup, run <code class="literal">esusers useradd</code> as the
      same user you use to run Elasticsearch. Running the command as root or some other user will update the permissions
      for the <code class="literal">users</code> and <code class="literal">users_roles</code> files and prevent Elasticsearch from accessing them.</p></div></div><p>Now that we’ve defined the roles and the users of the cluster, you can start the Elasticsearch node. You can check the
startup logs to verify that the Shield plugin has loaded and is using the <code class="literal">esusers</code> realm. In the next section, we’ll
configure the clients to interact with Elasticsearch using Shield.</p><h3><a id="clientauth"></a>Configuring HTTP REST Clients</h3><p>Elasticsearch works with standard HTTP <a class="ulink" href="http://en.wikipedia.org/wiki/Basic_access_authentication" target="_top">basic authentication</a>
headers to identify the requester. Since Elasticsearch is stateless, this header must be sent with every request:</p><pre class="programlisting prettyprint lang-shell">Authorization: Basic &lt;TOKEN&gt; <a id="CO3-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO3-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The <code class="literal">&lt;TOKEN&gt;</code> is computed as <code class="literal">base64(USERNAME:PASSWORD)</code>
</p></td></tr></table></div><h4><a id="_client_examples"></a>Client examples</h4><p>Using <code class="literal">curl</code> without basic authentication to create an index has the following result:</p><pre class="programlisting prettyprint lang-shell">curl -XPUT 'localhost:9200/idx'</pre><pre class="programlisting prettyprint lang-json">{
  "error":  "AuthenticationException[Missing authentication token]",
  "status": 401
}</pre><p>Since no user is associated with the request above, the request returns an authentication error. Next, use <code class="literal">curl</code>
with basic auth to create an index as the <code class="literal">rdeniro</code> user:</p><pre class="programlisting prettyprint lang-shell">curl --user rdeniro:taxidriver -XPUT 'localhost:9200/idx'</pre><pre class="programlisting prettyprint lang-json">{
  "acknowledged": true
}</pre><p>Since the request is executed on behalf of administrative user <code class="literal">rdeniro</code>, the create index request authenticates and
authorizes successfully, resulting in normal execution of the request. Creating another index as the <code class="literal">alpacino</code> user
results in the following error:</p><pre class="programlisting prettyprint lang-shell">curl --user alpacino:godfather -XPUT 'localhost:9200/idx2'</pre><pre class="programlisting prettyprint lang-json">{
  "error":  "AuthorizationException[Action [indices:admin/create] is unauthorized for user [alpacino]]",
  "status": 403
}</pre><p>As user <code class="literal">alpacino</code> does not have any index administration rights, the request is rejected with an authorization error.</p><h3><a id="_check_the_log"></a>Check the Log</h3><p>Take a look in your log file to make sure that your network transports are using Shield. A successful installation will show lines similar to the following:</p><pre class="programlisting prettyprint lang-shell">[2014-10-09 13:47:38,841][INFO ][transport ] [Ezekiel Stane] Using [org.elasticsearch.shield.transport.SecuredTransportService] as transport service, overridden by [shield]
[2014-10-09 13:47:38,841][INFO ][transport ] [Ezekiel Stane] Using [org.elasticsearch.shield.transport.netty.NettySecuredTransport] as transport, overridden by [shield]
[2014-10-09 13:47:38,842][INFO ][http      ] [Ezekiel Stane] Using [org.elasticsearch.shield.transport.netty.NettySecuredHttpServerTransport] as http transport, overridden by [shield]</pre><h3><a id="_next_steps_2"></a>Next Steps</h3><p>Now you have a working cluster with authentication and access control enabled.
In the <a class="link" href="authorization.html" title="Authorization"><span class="emphasis"><em>Authorization</em></span></a> section, we explain how to manage users and their roles. The
<a class="link" href="authentication.html" title="Authentication"><span class="emphasis"><em>Authentication</em></span></a> section explains how to use Shield’s authentication realms and LDAP integration. The
<a class="link" href="securing-nodes.html" title="Securing Nodes"><span class="emphasis"><em>Securing Nodes</em></span></a> section discusses enabling SSL/TLS encryption for nodes and clients.</p></div><div class="navfooter"><span class="prev"><a href="quick-getting-started.html">
              « 
              Getting Started (Short Version)</a>
           
        </span><span class="next">
           
          <a href="authorization.html">Authorization
               »
            </a></span></div>
<!-- end body -->

            </section>

            <div id="rtpcontainer"
        >
	<h3>Top Videos</h3>
	<ul class="lists">
		<li><a href="http://www.elastic.co/webinars/getting-started-with-elasticsearch/?elektra=docs">Getting Started</a></li>
		<li><a href="http://www.elastic.co/webinars/elasticsearch-performance-optimization-tale-two-tickets/?elektra=docs">Scaling</a></li>
		<li><a href="http://www.elastic.co/webinars/shield-securing-your-data-in-elasticsearch/?elektra=docs">Security</a></li>
	</ul>
</div>


	  	

  	<!-- Footer -->
	<div id="footer-wrapper">
		<section id="footer" class="container">
			<div class="row">
				<div class="12u">
					<!-- Copyright -->
					<div id="copyright">
	<p>
		© 2015. All Rights Reserved - Elasticsearch
	</p>
	<ul class="links">
		<li>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</li>
		<li><a href="/legal/trademarks" id="footer_trademarks">Trademarks</a></li>
		<li><a href="/legal/terms-of-use" id="footer_terms">Terms</a></li>
		<li><a href="/legal/privacy-policy" id="footer_privacy">Privacy</a></li>
	</ul>
	<p>
		Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other&nbsp;countries.
	</p>
</div><!--<div class="row">
{replace4}
</div>-->
				</div>
			</div>					
		</section>
	</div>
			
	<!-- Social Media -->
	<div id="socialmedia-wrapper">
		<section id="socialmedia" class="container">
			<!-- social icons -->
			<div id="social">
				<ul class="links">
					
						<li class="facebook grayscale"><a href="http://www.facebook.com/elastic.co" target="_blank" id="footer_facebook"></a></li>
					
						<li class="twitter grayscale"><a href="https://www.twitter.com/elastic" target="_blank" id="footer_twitter"></a></li>
					
						<li class="linkedin grayscale"><a href="http://www.linkedin.com/company/elasticsearch" target="_blank" id="footer_linkedin"></a></li>
					
						<li class="xing grayscale"><a href="https://www.xing.com/companies/elastic.co" target="_blank" id="footer_xing"></a></li>
					
				</ul>
			</div>
		</section>
	</div>


<style type="text/css">
	
		.facebook{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.twitter{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.linkedin{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.xing{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
</style>	

  	</div>
  	<!-- <div class="preloader">
    	<div class="status"></div>
	</div> -->
  	<style></style>
   	<script src="/static/js/jquery.min.js"></script>
<script src="/static/js/jquery.autocomplete.js"></script>
<script src="/static/js/script.js"></script>
   	
   	
   	
   	<script type="application/ld+json">
	{
	  	"@context": "http://schema.org",
	  	"@type": "Organization",
	  	"name" : "Elastic",
	  	"url": "https://www.elastic.co/",
	  	"logo": "https://www.elastic.co/static/img/logo-elastic.png",
		"sameAs" : [ "https://www.facebook.com/elastic.co",
			"https://twitter.com/elastic",
			"https://plus.google.com/105178019064686397293",
			"https://www.youtube.com/user/elasticsearch",
			"https://www.linkedin.com/company/elasticsearch"
		],
	  	"potentialAction": {
	    	"@type": "SearchAction",
	    	"target": "https://www.elastic.co/search?q={query_string}",
	    	"query-input": "required name=query_string"
	  	}
	}
</script>	

            <script type="text/javascript">
  jQuery(function() {
    jQuery('#rtpcontainer').prependTo('#guide');
    jQuery('#guide a[id]').each(function() { this.href='#'+this.id });
    jQuery('pre.prettyprint').each(function() {
      var pre = jQuery(this);
      pre.css('position','absolute');
      pre.css('width','auto');
      var height = pre.innerHeight();
      pre.wrap('<div class="pre_wrapper" style="height:' + (10 + height) + 'px"></div>');
    })
  });
</script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>
<script type="text/javascript" >
  (function ($, $a, $title, $list) {
    $a = $('[id^="js-api-method-index"]');
    if (!$a.size()) return;
    $('#guide').addClass('js-client-docs');
    $list = $a.siblings('.itemizedlist').detach();
    $title = $(document.createElement('h2')).text('api methods')
    $a.parent().remove();
    $('.toc').first().append($(document.createElement('div')).addClass('js-api-method-index').append($title).append($list));
  }(jQuery));
</script>

            </body>
        