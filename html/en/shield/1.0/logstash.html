
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Shield with Logstash</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Shield - Elasticsearch Security Plugin" /><link rel="up" href="clients.html" title="Integrating Shield with clients" /><link rel="prev" href="_http_rest_clients.html" title="HTTP/REST Clients" /><link rel="next" href="marvel.html" title="Shield with Marvel" />
  
 
 	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
 	
	<meta name="description" content="" />
	<meta name="keywords" content="" />



	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
	<link type="text/css" rel="stylesheet" href="/static/css/skel.css" />		
	
	<script src="/static/js/jquery.min.js"></script>
	<script src="/static/js/loading.js"></script>
	<script src="/static/js/skel.min.js"></script>
	<script src="/static/js/skel-layers.min.js"></script>
	<script src="/static/js/classie.js"></script>	
	<script type="text/javascript">form_name = "common_layout"</script>
	<script src="/static/js/init.js"></script>
	
	<link type="text/css" rel="stylesheet" href="/static/css/prettify.css" />	
	<script type="text/javascript" src="/static/js/prettify.js"></script>



<link rel="stylesheet" type="text/css" href="/static/css/style.css" />
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript">
  jQuery(function() {
    jQuery('#guide a[id]').each(function() { this.href='#'+this.id });
    jQuery('pre.prettyprint').each(function() {
      var pre = jQuery(this);
      pre.css('position','absolute');
      pre.css('width','auto');
      var height = pre.innerHeight();
      pre.wrap('<div class="pre_wrapper" style="height:' + height + 'px"></div>');
    })
  });
</script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

</head>
<body >
	<!-- Google Tag Manager -->
	<script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5"
													  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script>
	<!-- End Google Tag Manager -->
	
	<div class="header-cont">
		<div id="header-wrapper">
			

<div class="container">
	<div class="row">
		<div class="12u">
			<section>
				<div class="row">
					<div class="8u 6u(small) 5u(xsmall)">
						<div id="elastic">
							<h1><a href="/"></a></h1>
						</div>
						<!-- Searchbar Input box -->
						<div class="header-search-form">
						   <input type="text" id="search-header" name="q" class="form-control global-input" placeholder="{elastic} search">
						</div>
					</div>
					<div class="4u 6u(small) 7u(xsmall)">
						<!-- Mobile Menu -->
						<div class="mobile-menu-wrapper">
							<ul class="m-shortcuts">
								<li><a id="header-search" class="m-search" href="#"></a></li>
								<li><a class="m-guide" href="#"></a></li>
							</ul>											
							<nav class="nav-menu">
								<div class="menu-button">
									<span></span>
								</div>
								<div class="nav-menu-list-wrap">
									<div class="nav-menu-list">
										<h3><a href="#">Products</a></h3>
										<ul>
											<li><a href="#">elasticsearch</a></li>
											<li><a href="#">logstash</a></li>
											<li><a href="#">kibana</a></li>
											<li><a href="#">shield</a></li>
											<li><a href="#">marvel</a></li>
											<li><a href="#">hadoop</a></li>
											<li><a href="#">support</a></li>
											<li><a href="#">downloads</a></li>
										</ul>
										<h3><a href="#">SUBSCRIPTIONS</a></h3>
										<h3><a href="#">LEARN</a></h3>
										<ul>
											<li><a href="#">guide</a></li>
											<li><a href="#">videos</a></li>
											<li><a href="#">training</a></li>
											<li><a href="#">blog</a></li>
										</ul>
									</div>
								</div>
							</nav>
						</div>
						<!-- Shortcuts -->
						<nav id="shortcuts">
							<ul class="links">
								
									<li class="sc-downloads grayscale"><a href="/downloads" id="header_downloads">downloads</a></li>
								
									<li class="sc-guide grayscale"><a href="/guide" id="header_guide">guide</a></li>
								
									<li class="sc-support grayscale"><a href="/subscriptions" id="header_subscriptions">support</a></li>
								
									<li class="sc-contact grayscale"><a href="/contact" id="header_contact">contact</a></li>
								
							</ul>
						</nav>
					</div>
				</div>
			</section>
			

<section class="desktop-main-nav">
	<div class="row">
		<div class="9u">
			<!-- Nav -->
			<nav id="nav">
				<ul>
					
					<li>
						<a href="/products" id="nav_products" >PRODUCTS</a>
						
						<ul class="dropdown">
							
								<li><a href="/products/elasticsearch" id="nav_elasticsearch" >elasticsearch</a></li>								
							
								<li><a href="/products/logstash" id="nav_logstash" >logstash</a></li>								
							
								<li><a href="/products/kibana" id="nav_kibana" >kibana</a></li>								
							
								<li><a href="/products/shield" id="nav_shield" >shield</a></li>								
							
								<li><a href="/products/marvel" id="nav_marvel" >marvel</a></li>								
							
								<li><a href="/products/hadoop" id="nav_hadoop" >hadoop</a></li>								
							
								<li><a href="/subscriptions" id="nav_support" >support</a></li>								
							
								<li><a href="/downloads" id="nav_downloads" >downloads</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/subscriptions" id="nav_subscriptions" >SUBSCRIPTIONS</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/learn" id="nav_learn" >LEARN</a>
						
						<ul class="dropdown">
							
								<li><a href="/guide" id="nav_guide" >guide</a></li>								
							
								<li><a href="/videos" id="nav_videos" >videos</a></li>								
							
								<li><a href="http://purchases.elasticsearch.com" id="nav_training" >training</a></li>								
							
								<li><a href="/blog" id="nav_learn_blog" >blog</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/community" id="nav_community" >COMMUNITY</a>
						
						<ul class="dropdown">
							
								<li><a href="/community/meetups" id="nav_meetups" >meetups</a></li>								
								
						</ul>							
					</li>
					
					<li>
						<a href="/use-cases" id="nav_usecases" >USE CASES</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/blog" id="nav_blog" >BLOG</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						<a href="/about" id="nav_about" >ABOUT</a>
						
						<ul class="dropdown">
							
								<li><a href="/about/leadership" id="nav_leadership" >leadership</a></li>								
							
								<li><a href="/about/board" id="nav_board" >board of directors</a></li>								
							
								<li><a href="/about/careers" id="nav_careers" >careers</a></li>								
							
								<li><a href="/about/partners" id="nav_partners" >partners</a></li>								
							
								<li><a href="/about/press" id="nav_press" >press</a></li>								
								
						</ul>							
					</li>
					
				</ul>
			</nav>
		</div>
		<!-- Search -->
		<div class="3u">
			<div id="searchbar">
				<form method="get" action="/search" name="searchForm">
					<input type="text" value="" name="q" placeholder="{elastic} search">
					<a class="button icon" onclick="searchForm.submit()">GO</a>
				</form>
			</div>
		</div>
	</div>
</section>

		</div>
	</div>
</div>

<style>	
	
		.sc-downloads{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-guide{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-support{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
	
		.sc-contact{ background: url("/assets/blt0b75d0822b89593e/shortcuts.png") no-repeat;}
		
</style>
		</div>
	</div>
  	<div id="content">
  		
            <div id="pageheader">
    <div class="container">
        <header>
            <h1>Learn |</h1>
            <h2>Docs</h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Shield - Elasticsearch Security Plugin</a></span> » <span class="breadcrumb-link"><a href="clients.html">Integrating Shield with clients</a></span> » <span class="breadcrumb-node">Shield with Logstash</span></div><div class="navheader"><span class="prev"><a href="_http_rest_clients.html">
              « 
              HTTP/REST Clients</a>
           
        </span><span class="next">
           
          <a href="marvel.html">Shield with Marvel
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="logstash"></a>Shield with Logstash</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="_java_clients.html">Java clients</a></span></dt><dt><span class="section"><a href="_http_rest_clients.html">HTTP/REST Clients</a></span></dt><dt><span class="section"><a href="logstash.html">Shield with Logstash</a></span></dt><dt><span class="section"><a href="marvel.html">Shield with Marvel</a></span></dt><dt><span class="section"><a href="kibana.html">Kibana</a></span></dt><dt><span class="section"><a href="_shield_with_kibana_3.html">Shield with Kibana 3</a></span></dt><dt><span class="section"><a href="_shield_with_kibana_4.html">Shield with Kibana 4</a></span></dt><dt><span class="section"><a href="hadoop.html">Shield with Elasticsearch for Apache Hadoop</a></span></dt></dl></div><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>Shield 1.0.x is compatible with Logstash 1.5 RC1 and above.</p></div></div><p>Logstash provides Elasticsearch <a class="ulink" href="http://logstash.net/docs/1.4.2/outputs/elasticsearch" target="_top">output</a>, <a class="ulink" href="http://logstash.net/docs/1.4.2/inputs/elasticsearch" target="_top">input</a> and <a class="ulink" href="http://logstash.net/docs/1.4.2/filters/elasticsearch" target="_top">filter</a> plugins
used to index and retrieve documents through HTTP, transport or client node protocols.
All plugins support authentication and encryption over HTTP, while the output plugin additionally supports these
features over the transport protocol.</p><p>Note: When using the elasticsearch output, only the <code class="literal">transport</code> and <code class="literal">http</code> protocol are supported (i.e. <code class="literal">node</code> protocol is unsupported)</p><p>For information on setting up authentication and authorization on the Elasticsearch side, check the corresponding
documentation sections: <a class="link" href="authorization.html" title="Authorization"><span class="emphasis"><em>Authorization</em></span></a> and <a class="link" href="authentication.html" title="Authentication"><span class="emphasis"><em>Authentication</em></span></a>.</p><p>To configure the certificates and other SSL related options, see <a class="link" href="securing-nodes.html" title="Securing Nodes"><span class="emphasis"><em>Securing Nodes</em></span></a>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ls-user"></a>Creating a user</h3></div></div></div><p>By default, the Shield plugin installs a dedicated user <a class="link" href="authorization.html#roles" title="Roles, Permissions and Privileges">role</a> that enables the creation of indices with names
that match the <code class="literal">logstash-*</code> regular expression, along with privileges to read, scroll, index, update, and delete
documents on those indices:</p><pre class="programlisting prettyprint lang-yaml">logstash:
  cluster: indices:admin/template/get, indices:admin/template/put
  indices:
    'logstash-*': indices:data/write/bulk, indices:data/write/delete, indices:data/write/update, indices:data/read/search, indices:data/read/scroll, create_index</pre><p>See the <a class="link" href="authorization.html#roles-file" title="The Role Definition File roles.yml"><span class="emphasis"><em>Role Definition File</em></span></a> section for information on modifying roles.</p><p>Create a user associated with the <code class="literal">logstash</code> role on the Elasticsearch cluster, using the <a class="link" href="esusers.html" title="esusers - Internal File Based Authentication"><code class="literal">esusers</code> tool</a>:</p><pre class="programlisting prettyprint lang-shell">esusers useradd &lt;username&gt; -p &lt;password&gt; -r logstash</pre><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>When using the transport protocol, the logstash user requires the predefined <code class="literal">transport_client</code> role in addition to the <code class="literal">logstash</code> role shown above (<code class="literal">-r logstash,transport_client</code>).</p></div></div><p>Once you’ve created the user, you are ready to configure Logstash.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ls-http"></a>Connecting with HTTP/HTTPS</h3></div></div></div><p>All three input, filter and output plugins support HTTP Basic Authentication as well as SSL/TLS.
The sections below demonstrate the output plugin’s configuration parameters, but input and filter are the same.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="ls-http-auth"></a>Basic Authentication</h4></div></div></div><p>To connect to an instance of Elasticsearch with Shield, set up the username and password credentials with the following
configuration parameters:</p><pre class="programlisting prettyprint lang-shell">input { ... }
output {
  elasticsearch {
    protocol =&gt; "http"
    ...
    user =&gt; ... # string
    password =&gt; ... # string
  }
}</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="ls-http-ssl"></a>SSL/TLS Configuration for HTTPS</h4></div></div></div><p>To enable SSL/TLS encryption for HTTPS, use the following configuration block:</p><pre class="programlisting prettyprint lang-shell">input { ... }
output {
  elasticsearch {
    protocol =&gt; "http"
    ...
    ssl =&gt; true
    cacert =&gt; '/path/to/cert.pem' <a id="CO17-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
  }
}</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO17-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The path to the <code class="literal">.pem</code> file in your filesystem that contains the Certificate Authority’s certificate.
</p></td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ls-transport"></a>Connecting with Transport protocol</h3></div></div></div><p>By setting the "protocol" option to "transport", Logstash communicates with the Elasticsearch cluster through the same
protocol nodes use between each other. This avoids JSON un/marshalling and is therefore more efficient.</p><p>In order to unlock this option, it’s necessary to install an additional plugin in Logstash using the following command:</p><pre class="programlisting prettyprint lang-shell">bin/plugin install logstash-output-elasticsearch-shield</pre><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="ls-transport-auth"></a>Authentication for Transport protocol</h4></div></div></div><p>To connect to an instance of Elasticsearch with Shield, set up the username and password credentials with the following
configuration parameters:</p><pre class="programlisting prettyprint lang-shell">input { ... }
output {
  elasticsearch {
    protocol =&gt; "transport"
    ...
    user =&gt; ... # string
    password =&gt; ... # string
  }
}</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="ls-transport-conf"></a>SSL Configuration for Transport or Node protocols</h4></div></div></div><p>Specify the paths to the keystore and truststore <code class="literal">.jks</code> files with the following configuration parameters:</p><pre class="programlisting prettyprint lang-shell">input { ... }
output {
  elasticsearch {
    protocol =&gt; "transport"
    host =&gt; ... # string (optional)
    cluster =&gt; ... # string (optional)
    ...
    ssl =&gt; true
    keystore =&gt;  ... # string
    keystore_password =&gt;  ... # string
    truststore =&gt;  ... # string
    truststore_password =&gt;  ... # string
  }
}</pre><p>For more information on encryption and certificates, see the <a class="link" href="ssl-tls.html" title="Encryption and Certificates">Securing Nodes</a> section:</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ls-failure"></a>Failures</h3></div></div></div><p>Logstash raises an exception that halts the processing pipeline when the server’s certificate does not validate over SSL
on any of the protocols discussed in this section. Same for the invalid user credentials.</p></div></div><div class="navfooter"><span class="prev"><a href="_http_rest_clients.html">
              « 
              HTTP/REST Clients</a>
           
        </span><span class="next">
           
          <a href="marvel.html">Shield with Marvel
               »
            </a></span></div>
<!-- end body -->

            </section>
<script type="text/javascript" >
  (function ($, $a, $title, $list) {
    $a = $('[id^="js-api-method-index"]');
    if (!$a.size()) return;
    $('#guide').addClass('js-client-docs');
    $list = $a.siblings('.itemizedlist').detach();
    $title = $(document.createElement('h2')).text('api methods')
    $a.parent().remove();
    $('.toc').first().append($(document.createElement('div')).addClass('js-api-method-index').append($title).append($list));
  }(jQuery));
</script>

            <!-- Footer -->
        
	<div id="footer-wrapper">
		<section id="footer" class="container">
			<div class="row">
				<div class="12u">
					<!-- Copyright -->
					<div id="copyright">
						<p>&copy; 2015. All Rights Reserved - Elasticsearch</p>
						<ul class="links">
							<li>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</li>
							
							<li><a href="/legal/trademarks" id="footer_trademarks">Trademarks</a></li>
							
							<li><a href="/legal/terms-of-use" id="footer_terms">Terms</a></li>
							
							<li><a href="/legal/privacy-policy" id="footer_privacy">Privacy</a></li>
							
						</ul>
					</div>
				</div>
			</div>					
		</section>
	</div>
			
	<!-- Social Media -->
	<div id="socialmedia-wrapper">
		<section id="socialmedia" class="container">
			<!-- social icons -->
			<div id="social">
				<ul class="links">
					
						<li class="facebook grayscale"><a href="http://www.facebook.com/elastic.co" target="_blank" id="footer_facebook"></a></li>
					
						<li class="twitter grayscale"><a href="https://www.twitter.com/elastic" target="_blank" id="footer_twitter"></a></li>
					
						<li class="linkedin grayscale"><a href="http://www.linkedin.com/company/elastic.co" target="_blank" id="footer_linkedin"></a></li>
					
						<li class="xing grayscale"><a href="https://www.xing.com/companies/elasticsearch" target="_blank" id="footer_xing"></a></li>
					
				</ul>
			</div>
		</section>
	</div>


<style type="text/css">
	
		.facebook{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.twitter{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.linkedin{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
		.xing{background:url("/assets/blte0d4d10ae3bd8337/social-media.png") no-repeat;}		
	
</style>	

  	</div>
  	<div class="preloader">
    	<div class="status"></div>
	</div>
  	<style></style>
   	<link type="text/css" rel="stylesheet" href="/static/css/flexslider.css" >

<script src="/static/js/jquery.flexslider.min.js"></script>
<script src="/static/js/jquery.dropdown.min.js"></script>
<script src="/static/js/script.js"></script>
   	
</body>